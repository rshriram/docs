
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <title>Amalgam8 Architecture Â· GitBook</title>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.0">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="amalgam8-components-registry.html" />
    
    
    <link rel="prev" href="getting-started-with-amalgam8.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="what-is-amalgam8.html">
            
                <a href="what-is-amalgam8.html">
            
                    
                    What is Amalgam8
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="getting-started-with-amalgam8.html">
            
                <a href="getting-started-with-amalgam8.html">
            
                    
                    Getting Started with Amalgam8
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.4" data-path="amalgam8-architecture.html">
            
                <a href="amalgam8-architecture.html">
            
                    
                    Amalgam8 Architecture
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="amalgam8-components-registry.html">
            
                <a href="amalgam8-components-registry.html#registry-root">
            
                    
                    Amalgam8 Registry
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.1" data-path="amalgam8-components-registry.html">
            
                <a href="amalgam8-components-registry.html#interoperability">
            
                    
                    Interoperability
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.1.1" data-path="amalgam8-components-registry.html">
            
                <a href="amalgam8-components-registry.html#k8s_adapter">
            
                    
                    Kubernetes-Registry Adapter
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="amalgam8-components-sidecar.html">
            
                <a href="amalgam8-components-sidecar.html#sidecar-root">
            
                    
                    Amalgam8 Sidecar
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.2.1" data-path="amalgam8-components-sidecar.html">
            
                <a href="amalgam8-components-sidecar.html#deployment_options">
            
                    
                    Deployment Options
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.2" data-path="amalgam8-components-sidecar.html">
            
                <a href="amalgam8-components-sidecar.html#configuration_options">
            
                    
                    Configuration Options
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.3" data-path="amalgam8-components-sidecar.html">
            
                <a href="amalgam8-components-sidecar.html#programmable_proxy">
            
                    
                    Programmable Proxy
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Amalgam8 Architecture</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h2 id="amalgam8-architecture">Amalgam8 Architecture</h2><p>The Amalgam8 platform consists of the following three components:</p><ol><li><p><strong>Registry</strong> - A high performance multi-tenant service registry that
provides a centralized view of all the microservices in an application,
regardless of where they are actually running. To simplify integration
of microservices that are already using a service registry, Amalgam8
registry provides a plug-in point for adapters that can automatically
pull in information from
other service registry solutions such as Etcd (used by Kubernetes),
Netflix Eureka, Consul, etc.</p></li>
<li><p><strong>Controller</strong> - A multi-tenant controller that monitors the registry
and updates the sidecar configuration accordingly. It provides APIs to
the developer for configuring request routing across different versions
of microservices, fault injection, etc. These controller generates
request routing rules and updates the sidecars belonging to the
developer&apos;s application.</p></li>
<li><p><strong>Sidecar</strong> -  Each microservice in the application is paired with a
sidecar. Conceptually, the sidecar&apos;s basic responsibility includes service
registration (where required), service discovery and <em>client-side load-balancing</em> of
requests across microservice instances. In addition to these basic
responsibilities, the sidecar is responsible for essential functions
such as version-aware routing, fault injection, ACLs, rate limiting,
etc. From a design standpoint, the choice of technology for the sidecar
is irrelevant. <em>Any implementation of the sidecar is sufficient (as a
library or a helper process) as long as the sidecar performs the above
functions and is dynamically programmable at runtime</em>.</p></li></ol>
<p>Amalgam8&apos;s sidecar implementation uses OpenResty + Nginx for request
routing, and employs a simple daemon for receiving and updating the routing
rules in Nginx, and for service registration &amp; heartbeat (where needed).</p><p>Applications run as tenants of the Registry and the Controller. They
register their services in the Registry and use the Controller to manage
the sidecars. The following diagram illustrates how the three components
work together.</p><p><img alt="how it works" src="figures/how-amalgam8-works.svg"></p><ol><li>Microservice instances are registered in the Registry. There are several
ways this may be accomplished as described in
<a href="#service-registration">Amalgam8 Registry</a>.
</li>
<li>The Developer uses the control plane API to configure high-level rules
for request routing between services (e.g., splitting traffic across
versions, injecting delays).
</li>
<li>The Controller translates these rules into low-level control information
and sends them to the sidecars. In addition, it also sends control
information when new information (e.g., new services, new instances)
appears in the Registry.
</li>
<li>A microservice invokes APIs of other microservices by pointing to the
sidecar as the destination host. For e.g., <a href="http://localhost:6379/servicefoo/foobarapi" target="_blank">http://localhost:6379/servicefoo/foobarapi</a>
</li>
<li>The Nginx proxy component of the sidecar forwards the request to the
appropriate microservice, depending on the request path and routing
rules specified by the controller.
</li></ol>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="getting-started-with-amalgam8.html" class="navigation navigation-prev " aria-label="Previous page: Getting Started with Amalgam8">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="amalgam8-components-registry.html#registry-root" class="navigation navigation-next " aria-label="Next page: Amalgam8 Registry">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Amalgam8 Architecture","level":"1.4","depth":1,"next":{"title":"Amalgam8 Registry","level":"1.4.1","depth":2,"anchor":"#registry-root","path":"content/amalgam8-components-registry.md","ref":"content/amalgam8-components-registry.md#registry-root","articles":[{"title":"Interoperability","level":"1.4.1.1","depth":3,"anchor":"#interoperability","path":"content/amalgam8-components-registry.md","ref":"content/amalgam8-components-registry.md#interoperability","articles":[{"title":"Kubernetes-Registry Adapter","level":"1.4.1.1.1","depth":4,"anchor":"#k8s_adapter","path":"content/amalgam8-components-registry.md","ref":"content/amalgam8-components-registry.md#k8s_adapter","articles":[]}]}]},"previous":{"title":"Getting Started with Amalgam8","level":"1.3","depth":1,"path":"content/getting-started-with-amalgam8.md","ref":"content/getting-started-with-amalgam8.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"content/amalgam8-architecture.md","mtime":"2016-07-07T03:21:48.000Z","type":"markdown"},"gitbook":{"version":"3.2.0","time":"2016-07-25T02:23:35.047Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

